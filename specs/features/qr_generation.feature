# language: ru
@critical @qr-generation
Функция: Генерация QR-кодов
  Как пользователь приложения
  Я хочу генерировать QR-коды с различным контентом
  Чтобы быстро делиться информацией через сканируемые изображения

  Предыстория:
    Дано приложение QR Suite загружено
    И я нахожусь на вкладке "Генератор"

  @smoke
  Сценарий: Генерация базового QR-кода с URL
    Дано я выбрал тип QR-кода "URL"
    Когда я ввожу "https://example.com" в поле URL
    И я нажимаю кнопку "Скачать QR"
    Тогда QR-код должен быть сгенерирован
    И QR-код должен содержать "https://example.com"
    И QR-код должен быть сканируемым

  @normalization
  Сценарий: Автоматическое добавление https:// к URL
    Дано я выбрал тип QR-кода "URL"
    Когда я ввожу "example.com" в поле URL
    И я нажимаю кнопку "Скачать QR"
    Тогда QR-код должен содержать "https://example.com"
    И протокол "https://" должен быть добавлен автоматически

  @validation @negative
  Сценарий: Валидация некорректного URL
    Дано я выбрал тип QR-кода "URL"
    Когда я ввожу "not_a_valid_url" в поле URL
    Тогда я должен увидеть сообщение об ошибке "Укажите корректный домен"
    И кнопка "Скачать QR" должна быть неактивна

  @styling
  Структура сценария: Генерация QR-кода для различных типов контента
    Дано я выбрал тип QR-кода "<тип>"
    Когда я заполняю поле "<поле>" значением "<значение>"
    И я нажимаю кнопку "Скачать QR"
    Тогда QR-код должен быть сгенерирован
    И QR-код должен содержать "<ожидаемый_контент>"
    И QR-код должен быть сканируемым

    Примеры:
      | тип      | поле    | значение               | ожидаемый_контент      |
      | URL      | url     | example.com            | https://example.com    |
      | Телефон  | phone   | +7 (900) 123-45-67     | tel:+79001234567       |
      | Email    | email   | test@example.com       | mailto:test@example.com|
      | SMS      | phone   | +79001234567           | SMSTO:+79001234567     |
      | Текст    | text    | Привет, мир!           | Привет, мир!           |

  @styling @customization
  Сценарий: Кастомизация внешнего вида QR-кода
    Дано я выбрал тип QR-кода "URL"
    И я ввожу "https://mysite.com" в поле URL
    Когда я открываю вкладку "Стиль"
    И я выбираю стиль точек "Скругленные"
    И я устанавливаю цвет переднего плана "#FF0000"
    И я включаю градиент
    Тогда превью QR-кода должно обновиться
    И превью должно показывать скругленные красные точки
    И QR-код должен оставаться сканируемым

  @accessibility @contrast
  Сценарий: Предупреждение о низком контрасте
    Дано я выбрал тип QR-кода "URL"
    И я ввожу "https://example.com" в поле URL
    Когда я устанавливаю цвет переднего плана "#FFFF00"
    И я устанавливаю цвет фона "#FFFFFF"
    Тогда должно появиться предупреждение о низком контрасте
    И система должна рекомендовать минимальное соотношение контрастности 4.5:1

  @export @formats
  Структура сценария: Экспорт QR-кода в различных форматах и размерах
    Дано я сгенерировал QR-код с URL "https://test.com"
    Когда я выбираю размер экспорта "<размер>"px
    И я выбираю формат "<формат>"
    И я нажимаю "Скачать QR"
    Тогда файл должен быть загружен
    И файл должен иметь расширение ".<формат>"
    И размер изображения должен быть "<размер>" x "<размер>" пикселей

    Примеры:
      | размер | формат |
      | 256    | png    |
      | 512    | png    |
      | 1024   | png    |
      | 2048   | svg    |
      | 4096   | svg    |

  @error-correction
  Структура сценария: Генерация QR-кодов с различными уровнями коррекции ошибок
    Дано я выбрал тип QR-кода "URL"
    И я ввожу "https://example.com" в поле URL
    Когда я открываю вкладку "Продвинутые"
    И я выбираю уровень коррекции ошибок "<уровень>"
    И я нажимаю "Скачать QR"
    Тогда QR-код должен быть сгенерирован с уровнем коррекции "<уровень>"
    И QR-код должен восстанавливаться при повреждении до <процент>%

    Примеры:
      | уровень | процент |
      | L       | 7       |
      | M       | 15      |
      | Q       | 25      |
      | H       | 30      |

  @logo @advanced
  Сценарий: Добавление логотипа в центр QR-кода
    Дано я сгенерировал QR-код с URL "https://mycompany.com"
    Когда я открываю вкладку "Продвинутые"
    И я загружаю изображение логотипа "logo.png"
    И я устанавливаю размер логотипа 20%
    Тогда превью должно показывать логотип в центре QR-кода
    И логотип не должен перекрывать критичные области
    И QR-код должен оставаться сканируемым

  @performance
  Сценарий: Быстрая генерация QR-кода
    Дано я выбрал тип QR-кода "URL"
    Когда я ввожу "https://example.com" в поле URL
    Тогда превью QR-кода должно обновиться в течение 500 миллисекунд
    И интерфейс не должен зависать во время генерации

  @mobile @telegram
  Сценарий: Генерация QR-кода в Telegram Mini App
    Дано я открыл приложение в Telegram
    И Telegram тема установлена как "темная"
    Когда я генерирую QR-код с URL "https://t.me/test"
    Тогда QR-код должен использовать цвета темной темы Telegram
    И при нажатии кнопок должна срабатывать тактильная обратная связь
    И QR-код должен быть оптимизирован для мобильных экранов

  @draft @persistence
  Сценарий: Автосохранение черновика
    Дано я выбрал тип QR-кода "URL"
    И я ввожу "https://example.com" в поле URL
    И я выбираю стиль "Скругленные"
    Когда я закрываю приложение
    И я снова открываю приложение
    Тогда мои настройки должны быть восстановлены
    И URL должен быть "https://example.com"
    И стиль должен быть "Скругленные"
